@model BulgarianHistory.Web.ViewModel.Timeline.TimelineViewModel

@{
    ViewData["Title"] = "Историческа времева линия";
}

<div class="container my-5 bg-dark text-light p-4 rounded shadow">
    <h1 class="text-center text-warning mb-4">История на България</h1>

    <div class="timeline-container overflow-x-auto">
        <svg height="400" width="2000" xmlns="http://www.w3.org/2000/svg">
            <!-- Главна линия -->
            <line x1="50" y1="150" x2="1950" y2="150" stroke="gold" stroke-width="5" />

            <!-- Малки години -->
            @for (int year = 600; year <= 2000; year += 100)
            {
                var x = 50 + (year - 600) * 2;
                <line x1="@x" y1="140" x2="@x" y2="160" stroke="gold" stroke-width="2" />
                @:<text x="@x" y="180" text-anchor="middle" fill="white" font-size="12">@year г.</text>
            }

            <!-- Основни исторически събития -->
            @{
                var importantEvents = new[]
                {
                    new { Year = 681, Title = "Създаване на България" },
                    new { Year = 864, Title = "Покръстване" },
                    new { Year = 1396, Title = "Османско робство" },
                    new { Year = 1878, Title = "Освобождение" },
                    new { Year = 1908, Title = "Независимост" },
                    new { Year = 1944, Title = "Комунизъм" },
                    new { Year = 1989, Title = "Преход към демокрация" },
                    new { Year = 2021, Title = "Съвременна България" }
                };

                foreach (var ev in importantEvents)
                {
                    var x = 50 + (ev.Year - 600) * 2;
                    @:<circle cx="@x" cy="150" r="6" fill="orange" />
                    @:<text x="@x" y="300" text-anchor="middle" fill="orange" font-size="13">@ev.Title</text>
                }
            }

            <!-- Събития от базата -->
            @foreach (var ev in Model.Events)
            {
                var x = 50 + (ev.Year - 600) * 2;
                <a xlink:href="/Event/Details/@ev.Id">
                    <circle cx="@x" cy="150" r="6" fill="orange" />
                    <text x="@x" y="120" text-anchor="middle" fill="white" font-size="13">@ev.Name</text>
                </a>
            }

            <!-- Епохи от базата -->
            @foreach (var era in Model.Eras)
            {
                var eraEvents = era.Events.ToList();
                var firstYear = eraEvents.Any() ? eraEvents.OrderBy(e => e.Year).First().Year : 600;
                var x = 50 + (firstYear - 600) * 2;
                <a xlink:href="/Era/Details/@era.Id">
                    <circle cx="@x" cy="220" r="8" fill="skyblue" />
                    <text x="@x" y="245" text-anchor="middle" fill="white" font-size="14">@era.Name</text>
                </a>
            }
        </svg>
    </div>
</div>

<style>
    .timeline-container {
        background-color: #212529;
        border: 2px solid #ffc107;
        padding: 20px;
        overflow-x: auto;
        white-space: nowrap;
    }
</style>